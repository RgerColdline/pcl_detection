# ============================================================================
# 节点级参数（话题、跳帧等）
# ============================================================================
input_topic: "/livox/lidar"
result_topic: "/pcl_detection/result"
objects_topic: "/pcl_detection/objects"
skip_frames: 0

# ============================================================================
# 全局处理开关（可被其他节点动态修改）
# ============================================================================
# 设置为 false 时，节点将跳过点云处理，直接返回空结果
# 其他节点可通过 `rosparam set enable_pcl_processing false/true` 动态控制
enable_pcl_processing: true

# ============================================================================
# 日志控制参数
# ============================================================================
# 日志输出频率控制（两种方式选一）：
# 方式 1：基于帧数 - 每 N 帧输出一次日志（0=每次都输出，19=每 20 帧输出 1 次）
log_skip_frames: 19
# 方式 2：基于时间 - 每 N 秒输出一次（0=禁用，2.0=每 2 秒输出一次）
log_interval_sec: 2.0
# Livox 日志级别：0=无，1=摘要，2=详细
livox_debug_level: 2

# ============================================================================
# 时间测量配置
# ============================================================================
timing:
  enable: true
  downsample: true
  walls: true
  cylinders: true
  circles: true
  total: true

# ============================================================================
# 下采样配置
# ============================================================================
downsample_config:
  approx: true  # true=ApproximateVoxelGrid(更快精度略低), false=VoxelGrid(标准)
  leaf_size: 0.05  #升高提速，降低提升精度

# ============================================================================
# 墙体检测配置
# ============================================================================
wall_extraction:
  enable: true  #是否启用检测墙体
  using_normal: true  #是否使用法线信息
  distance_threshold: 0.04  #距离阈值,越低越严格
  min_inliers: 1500  #点数阈值，低于这个点数的平面不算在内
  angle_threshold: 15.0 #角度阈值，单位度，平面法线与垂直方向的夹角必须小于这个值才算墙体
  axis: [0, 0, 1]  #参考的与墙面平行的向量

# ============================================================================
# 圆柱检测配置
# ============================================================================
cylinder_extraction:
  enable: true  #是否启用检测圆柱
  using_normal: false  #是否使用法线信息（建议使用，可提高检测精度）
  distance_threshold: 0.06  #距离阈值，点到圆柱模型的最大允许距离
  min_inliers: 300  #点数阈值，圆柱内点数量必须大于此值
  radius_min: 0.1  #最小半径（米），小于此半径的圆柱不会被检测
  radius_max: 1  #最大半径（米），大于此半径的圆柱不会被检测
  axis: [0, 0, 1]  #圆柱轴向参考向量，用于约束圆柱方向
  eps_angle: 25.0  #角度容差（度），圆柱轴向与参考轴的最大允许夹角

# ============================================================================
# 圆环检测配置
# ============================================================================
circle_extraction:
  enable: true  #是否启用检测圆环
  using_normal: false  #是否使用法线信息（建议使用，可提高检测精度）
  distance_threshold: 0.03  #距离阈值，点到圆环模型的最大允许距离
  min_inliers: 80  #点数阈值，圆环内点数量必须大于此值
  radius_min: 0.2  #最小半径（米），小于此半径的圆环不会被检测
  radius_max: 0.7  #最大半径（米），大于此半径的圆环不会被检测
  plane_distance_threshold: 0.06  #平面提取距离阈值，用于提取圆环所在平面
  plane_angle_threshold: 45.0  #平面角度阈值（度），平面法线与垂直方向的最大夹角
  plane_normal_z_max: 0.7  #平面法向量 Z 分量最大值，用于筛选竖直平面
  min_coverage_angle: 240.0  #最小覆盖角度（度），圆环必须覆盖至少这么多角度
  ransac_iterations: 200  #RANSAC 迭代次数，越高越准确但越慢
  max_circles: 5  #最大检测圆环数量
  normal_tolerance: 0.5  #法向量容差，用于验证圆环法向量方向

# ============================================================================
# 其他配置
# ============================================================================
save_objects: false #是否保存检测到的对象点云
output_dir: "/home/jetson/detected_objects"

# ============================================================================
# 点云采样配置（points_samples 节点专用）
# ============================================================================
points_sample_config:
  enable_livox_callback: true # 是否启用 Livox 点云回调
  save_sample_param: "/livox/save_sample" # 触发保存的 ROS 参数名称
